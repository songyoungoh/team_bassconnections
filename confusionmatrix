// credits to song, dary, and malini!

// Calculate the confusion matrix
conf_matrix = confusion_matrix(true_labels, predictions)
conf_matrix = conf_matrix.astype('float') / conf_matrix.sum(axis=1)[:, np.newaxis]

class_labels = [str(i) for i in range(num_classes)]

//heatmap
plt.figure(figsize=(10, 8))
sns.set(font_scale=0.7)
ax = sns.heatmap(conf_matrix, annot=True, fmt='.2f', cmap='YlOrBr',
                 xticklabels=class_labels,
                 yticklabels=class_labels)
plt.xlabel('Predicted Label')
plt.ylabel('True Label')
plt.title('Confusion Matrix (Using ResNet-50 model pretrained on ImageNet on EuroSAT data)')

//rotation necessary
ax.set_xticklabels(ax.get_xticklabels(), rotation=45)

for _, spine in ax.spines.items():
    spine.set_visible(True)
    spine.set_color('black')

plt.show()
